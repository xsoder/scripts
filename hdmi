#!/usr/bin/env bash

# Set environment variables for the X session
export DISPLAY=:0
export XAUTHORITY="/home/$USER/.Xauthority"

# Track HDMI status
HDMI_CONNECTED=0

while true; do
    # Check if HDMI is connected
    if xrandr | grep "HDMI-1 connected" >/dev/null; then
        if [ $HDMI_CONNECTED -eq 0 ]; then
            # HDMI was previously disconnected, now connected
            HDMI_CONNECTED=1
            # Mirror eDP-1 to HDMI-1
            xrandr --output HDMI-1 --auto --same-as eDP-1
            echo "HDMI connected: Mirrored eDP-1 to HDMI-1"
        fi
    else
        HDMI_CONNECTED=0
    fi
    sleep 2
done
